@Library("jenlib") _

boolean executeHwTests = [
		!isTriggeredByGerrit(),
		env.GERRIT_PROJECT == "calix"
].any({ it })

Map<String, Object> pipelineOptions = [
		projects           : ["calix"],
		container          : [app: "dls"],
		notificationChannel: "#dls-software"
]

if (executeHwTests) {
	pipelineOptions << [
			testOptions      : "--test-execall -j1",
			testSlurmResource: [partition: "cube", wafer: 62, "fpga-without-aout": 3],
			preTestHook      : { configureHxCubeBitfile() },
	]
}

wafDefaultPipeline(pipelineOptions)
