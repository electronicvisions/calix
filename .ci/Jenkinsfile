@Library("jenlib") _

boolean executeHwTests = [
		!isTriggeredByGerrit(),
		env.GERRIT_PROJECT == "calix"
].any({ it })

Map<String, Object> pipelineOptions = [
		projects           : ["calix"],
		container          : [app: "dls"],
		notificationChannel: "#dls-software",
		configureInstallOptions: "--build-profile=ci"
]

if (executeHwTests) {
	pipelineOptions << [
			testOptions      : "--test-execall -j1",
			testSlurmResource: [partition: "cube",
			                    wafer: 62,
			                    "fpga-without-aout": 0,
			                    time: "2:00:00"],
			preTestHook      : { configureHxCubeBitfile() },
	]
}

wafDefaultPipeline(pipelineOptions)
